"use strict";function getPixelsPerRem(){var e=document.querySelector("html");return Number(getComputedStyle(e).fontSize.slice(0,-2))}function setPixelsPerRem(){document.documentElement.style.setProperty("--ppr",getPixelsPerRem())}function openLoginDialog(){document.body.classList.add("has-modal");var e='button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])',t=document.querySelector("#modal-login");t.removeAttribute("hidden");var o=t.querySelectorAll(e)[0],s=t.querySelectorAll(e),i=s[s.length-1];document.addEventListener("keydown",(function(e){var t="Tab"===e.key||9===e.keyCode;if("Escape"===e.key||27===e.keyCode)return closeLoginDialog(),void setTimeout((function(){document.getElementById("login-button").focus()}),50);t&&(e.shiftKey?document.activeElement===o&&(i.focus(),e.preventDefault()):document.activeElement===i&&(o.focus(),e.preventDefault()))})),document.getElementById("auth-form").addEventListener("submit",(function(e){e.preventDefault();var t=document.getElementById("login").value;window.localStorage.setItem("login",t),renderAuthBlock(),closeLoginDialog(),setTimeout((function(){document.getElementById("auth-user").focus()}),50)})),o.focus()}function closeLoginDialog(){var e=document.querySelector("#modal-login");document.body.classList.remove("has-modal"),e.setAttribute("hidden",!0)}function openLogoutDialog(){document.body.classList.add("has-modal");var e='button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])',t=document.querySelector("#modal-logout");t.removeAttribute("hidden");var o=t.querySelectorAll(e)[0],s=t.querySelectorAll(e),i=s[s.length-1];document.addEventListener("keydown",(function(e){var t="Tab"===e.key||9===e.keyCode;if("Escape"===e.key||27===e.keyCode)return closeLogoutDialog(),void setTimeout((function(){document.getElementById("logout-button").focus()}),50);t&&(e.shiftKey?document.activeElement===o&&(i.focus(),e.preventDefault()):document.activeElement===i&&(o.focus(),e.preventDefault()))})),document.getElementById("logout-form").addEventListener("submit",(function(e){e.preventDefault(),window.localStorage.removeItem("login"),renderAuthBlock(),closeLogoutDialog(),setTimeout((function(){document.getElementById("login-button").focus()}),50)})),o.focus()}function closeLogoutDialog(){var e=document.querySelector("#modal-logout");document.body.classList.remove("has-modal"),e.setAttribute("hidden",!0)}function openSubscribeDialog(){document.body.classList.add("has-modal");var e='button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])',t=document.querySelector("#modal-subscribe");t.removeAttribute("hidden");var o=t.querySelectorAll(e)[0],s=t.querySelectorAll(e),i=s[s.length-1];document.addEventListener("keydown",(function(e){var t="Tab"===e.key||9===e.keyCode;if("Escape"===e.key||27===e.keyCode)return closeSubscribeDialog(),void setTimeout((function(){document.getElementById("subscribe-button").focus()}),50);t&&(e.shiftKey?document.activeElement===o&&(i.focus(),e.preventDefault()):document.activeElement===i&&(o.focus(),e.preventDefault()))})),o.focus()}function closeSubscribeDialog(){var e=document.querySelector("#modal-subscribe");document.body.classList.remove("has-modal"),e.setAttribute("hidden",!0)}function setMuseumInfoRoverFocus(){function e(e){var t;this.el=document.querySelector(e),this.buttons=(t=this.el.querySelectorAll("button"),Array.prototype.slice.call(t)),this.selected=0,this.focusedButton=this.buttons[this.selected],this.el.addEventListener("keyup",this.handleKeyUp.bind(this)),this.el.addEventListener("click",this.handleClick.bind(this))}e.prototype.handleKeyUp=function(e){switch(e.keyCode){case 37:e.preventDefault(),0===this.selected?this.selected=this.buttons.length-1:this.selected--;break;case 39:e.preventDefault(),this.selected===this.buttons.length-1?this.selected=0:this.selected++}this.changeFocus(this.selected)},e.prototype.handleClick=function(e){for(var t=e.target.parentNode.children,o=0;o<t.length&&e.target!=t[o];o++);this.selected=o,this.changeFocus(this.selected)},e.prototype.changeFocus=function(e){this.focusedButton.tabIndex=-1,this.focusedButton.classList.remove("is-active"),document.getElementById(this.focusedButton.getAttribute("aria-controls")).setAttribute("hidden",!0),this.focusedButton=this.buttons[e],this.focusedButton.tabIndex=0,this.focusedButton.focus(),this.focusedButton.classList.add("is-active"),document.getElementById(this.focusedButton.getAttribute("aria-controls")).removeAttribute("hidden")};new e("#museum-info-tabs")}function setPromoRoverFocus(){function e(e){var t;this.el=document.querySelector(e),this.slides=(t=this.el.querySelectorAll("li"),Array.prototype.slice.call(t)),this.selected=0,this.focusedSlide=this.slides[this.selected],this.el.addEventListener("keyup",this.handleKeyUp.bind(this)),this.prevButton=this.el.querySelectorAll("#promo-prev"),this.nextButton=this.el.querySelectorAll("#promo-next"),this.prevButton[0].addEventListener("click",this.scrollBackwards.bind(this)),this.nextButton[0].addEventListener("click",this.scrollForward.bind(this))}e.prototype.scrollForward=function(e){console.log("forward"),e.preventDefault(),this.selected===this.slides.length-1?this.selected=0:this.selected++,this.changeFocus(this.selected)},e.prototype.scrollBackwards=function(e){console.log("back"),e.preventDefault(),0===this.selected?this.selected=this.slides.length-1:this.selected--,this.changeFocus(this.selected)},e.prototype.handleKeyUp=function(e){switch(e.keyCode){case 37:this.scrollBackwards(e);break;case 39:this.scrollForward(e)}},e.prototype.changeFocus=function(e){this.focusedSlide.tabIndex=-1,this.focusedSlide.classList.remove("is-active"),this.focusedSlide.setAttribute("hidden",!0),this.focusedSlide=this.slides[e],this.focusedSlide.tabIndex=0,this.focusedSlide.classList.add("is-active"),this.focusedSlide.removeAttribute("hidden");var t=this.focusedSlide.getAttribute("data-title"),o=this.slides.length,s="".concat(t,", Слайд ").concat(e+1," из ").concat(o);document.getElementById("current-slide-title").innerText=s};new e("#promo")}function setEventsRoverFocus(){function e(e){var t;this.el=document.querySelector(e),this.buttons=(t=this.el.querySelectorAll("button"),Array.prototype.slice.call(t)),this.selected=0,this.focusedButton=this.buttons[this.selected],this.el.addEventListener("keyup",this.handleKeyUp.bind(this)),this.el.addEventListener("click",this.handleClick.bind(this))}e.prototype.handleKeyUp=function(e){switch(e.keyCode){case 37:e.preventDefault(),0===this.selected?this.selected=this.buttons.length-1:this.selected--;break;case 39:e.preventDefault(),this.selected===this.buttons.length-1?this.selected=0:this.selected++}this.changeFocus(this.selected)},e.prototype.handleClick=function(e){for(var t=e.target.parentNode.children,o=0;o<t.length&&e.target!=t[o];o++);this.selected=o,this.changeFocus(this.selected)},e.prototype.changeFocus=function(e){this.focusedButton.tabIndex=-1,this.focusedButton.classList.remove("is-active");var t=document.getElementById("events-list").querySelectorAll("[data-filter]");this.focusedButton=this.buttons[e],this.focusedButton.tabIndex=0,this.focusedButton.focus(),this.focusedButton.classList.add("is-active");var o=this.focusedButton.getAttribute("data-filter");console.log("filter",o),t.forEach((e=>{var t=e.getAttribute("data-filter");console.log("itemFilter",t),"all"===o||t===o?e.removeAttribute("hidden"):e.setAttribute("hidden",!0)}))};new e("#events-filter")}function onSubsribeSubmit(){document.getElementById("subscribe-form").addEventListener("submit",(function(e){e.preventDefault(),document.getElementById("email-address").innerText=document.getElementById("subscribe-email").value,openSubscribeDialog()}))}setPixelsPerRem(),setMuseumInfoRoverFocus(),setPromoRoverFocus(),setEventsRoverFocus(),onSubsribeSubmit();