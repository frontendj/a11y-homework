<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Blocks' random alignment with CSS</title><meta name="description" content="Front end developer / swing dj / traveller / coffee lover"><link rel="alternate" href="/feed/rss.xml" type="application/atom+xml" title="Mitya Kuznetsov"><link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90' transform='scale(1, -1)' transform-origin='50 50%' filter='invert(45%) sepia(71%) saturate(1655%) hue-rotate(161deg) brightness(93%) contrast(103%)'>üóëÔ∏è</text></svg>"><meta property="og:url" content="http://frontendj.ru/posts/blocks-random-alignment-with-css/"><meta property="og:title" content="Blocks' random alignment with CSS ‚Ä¢ Mitya Kuznetsov"><meta property="og:description" content="Front end developer / swing dj / traveller / coffee lover"><meta property="og:image" content="http://frontendj.ru/images/og.jpg"><meta property="og:type" content="website"><meta name="google-site-verification" content="_NotP0r5D8W-2bd04cg8fgo8qohmCpYqETdOhoY-CJI"><style>:root{--page-gap-horizontal:20px;--page-gap-vertical:20px;--page-max-width:1200px}:root{--base-blue:222,69%;--base-purple:270,60%;--color-primary:hsla(var(--base-blue), 40%, 100%);--color-link-base:var(--base-blue);--color-link-visited-base:var(--base-purple);--color-link:hsla(var(--color-link-base), 40%, 100%);--color-link-hover:hsla(var(--color-link-base), 30%, 100%);--color-link-visited:hsla(var(--color-link-visited-base), 60%, 100%)}:root{--font-family-system:system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Ubuntu,Helvetica Neue,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji}:root{--fluid-min-width:320;--fluid-max-width:600;--fluid-screen:100vw;--fluid-bp:0rem}@media screen and (min-width:320px){:root{--fluid-bp:calc((var(--fluid-screen) - var(--fluid-min-width) / 16 * 1rem) / (var(--fluid-max-width) - var(--fluid-min-width)))}}@media screen and (min-width:600px){:root{--fluid-screen:calc(var(--fluid-max-width) * 1px)}}:root{--fc-3xs-min:(var(--fc-s-min) * 0.25);--fc-3xs-max:(var(--fc-s-max) * 0.25);--fc-2xs-min:(var(--fc-s-min) * 0.5);--fc-2xs-max:(var(--fc-s-max) * 0.5);--fc-xs-min:(var(--fc-s-min) * 0.75);--fc-xs-max:(var(--fc-s-max) * 0.75);--fc-s-min:(var(--f-0-min, 12));--fc-s-max:(var(--f-0-max, 16));--fc-m-min:(var(--fc-s-min) * 1.5);--fc-m-max:(var(--fc-s-max) * 1.5);--fc-l-min:(var(--fc-s-min) * 2);--fc-l-max:(var(--fc-s-max) * 2);--fc-xl-min:(var(--fc-s-min) * 3);--fc-xl-max:(var(--fc-s-max) * 3);--fc-2xl-min:(var(--fc-s-min) * 4);--fc-2xl-max:(var(--fc-s-max) * 4);--fc-3xl-min:(var(--fc-s-min) * 6);--fc-3xl-max:(var(--fc-s-max) * 6);--space-3xs:calc(((var(--fc-3xs-min) / var(--ppr, 16)) * 1rem) + (var(--fc-3xs-max) - var(--fc-3xs-min)) * var(--fluid-bp));--space-2xs:calc(((var(--fc-2xs-min) / var(--ppr, 16)) * 1rem) + (var(--fc-2xs-max) - var(--fc-2xs-min)) * var(--fluid-bp));--space-xs:calc(((var(--fc-xs-min) / var(--ppr, 16)) * 1rem) + (var(--fc-xs-max) - var(--fc-xs-min)) * var(--fluid-bp));--space-s:calc(((var(--fc-s-min) / var(--ppr, 16)) * 1rem) + (var(--fc-s-max) - var(--fc-s-min)) * var(--fluid-bp));--space-m:calc(((var(--fc-m-min) / var(--ppr, 16)) * 1rem) + (var(--fc-m-max) - var(--fc-m-min)) * var(--fluid-bp));--space-l:calc(((var(--fc-l-min) / var(--ppr, 16)) * 1rem) + (var(--fc-l-max) - var(--fc-l-min)) * var(--fluid-bp));--space-xl:calc(((var(--fc-xl-min) / var(--ppr, 16)) * 1rem) + (var(--fc-xl-max) - var(--fc-xl-min)) * var(--fluid-bp));--space-2xl:calc(((var(--fc-2xl-min) / var(--ppr, 16)) * 1rem) + (var(--fc-2xl-max) - var(--fc-2xl-min)) * var(--fluid-bp));--space-3xl:calc(((var(--fc-3xl-min) / var(--ppr, 16)) * 1rem) + (var(--fc-3xl-max) - var(--fc-3xl-min)) * var(--fluid-bp));--space-3xs-2xs:calc(((var(--fc-3xs-min) / var(--ppr, 16)) * 1rem) + (var(--fc-2xs-max) - var(--fc-3xs-min)) * var(--fluid-bp));--space-2xs-xs:calc(((var(--fc-2xs-min) / var(--ppr, 16)) * 1rem) + (var(--fc-xs-max) - var(--fc-2xs-min)) * var(--fluid-bp));--space-xs-s:calc(((var(--fc-xs-min) / var(--ppr, 16)) * 1rem) + (var(--fc-s-max) - var(--fc-xs-min)) * var(--fluid-bp));--space-s-m:calc(((var(--fc-s-min) / var(--ppr, 16)) * 1rem) + (var(--fc-m-max) - var(--fc-s-min)) * var(--fluid-bp));--space-m-l:calc(((var(--fc-m-min) / var(--ppr, 16)) * 1rem) + (var(--fc-l-max) - var(--fc-m-min)) * var(--fluid-bp));--space-l-xl:calc(((var(--fc-l-min) / var(--ppr, 16)) * 1rem) + (var(--fc-xl-max) - var(--fc-l-min)) * var(--fluid-bp));--space-xl-2xl:calc(((var(--fc-xl-min) / var(--ppr, 16)) * 1rem) + (var(--fc-2xl-max) - var(--fc-xl-min)) * var(--fluid-bp));--space-2xl-3xl:calc(((var(--fc-2xl-min) / var(--ppr, 16)) * 1rem) + (var(--fc-3xl-max) - var(--fc-2xl-min)) * var(--fluid-bp))}:root{--f--1-min:12.00;--f--1-max:15.00;--step--1:calc( ((var(--f--1-min) / var(--ppr, 16)) * 1rem) + (var(--f--1-max) - var(--f--1-min)) * var(--fluid-bp) );--f-0-min:14.00;--f-0-max:18.00;--step-0:calc( ((var(--f-0-min) / var(--ppr, 16)) * 1rem) + (var(--f-0-max) - var(--f-0-min)) * var(--fluid-bp) );--f-1-min:16.33;--f-1-max:21.60;--step-1:calc( ((var(--f-1-min) / var(--ppr, 16)) * 1rem) + (var(--f-1-max) - var(--f-1-min)) * var(--fluid-bp) );--f-2-min:19.06;--f-2-max:25.92;--step-2:calc( ((var(--f-2-min) / var(--ppr, 16)) * 1rem) + (var(--f-2-max) - var(--f-2-min)) * var(--fluid-bp) );--f-3-min:22.23;--f-3-max:31.10;--step-3:calc( ((var(--f-3-min) / var(--ppr, 16)) * 1rem) + (var(--f-3-max) - var(--f-3-min)) * var(--fluid-bp) );--f-4-min:25.94;--f-4-max:37.32;--step-4:calc( ((var(--f-4-min) / var(--ppr, 16)) * 1rem) + (var(--f-4-max) - var(--f-4-min)) * var(--fluid-bp) )}.header-1{font-weight:600;font-size:var(--font-size,var(--step-4));line-height:var(--line-height,1.3);min-height:0}.p-1{font-size:var(--font-size,var(--step-0));line-height:var(--line-height,1.5);min-height:0}*,::after,::before{box-sizing:border-box}body,h1,html,li,p,ul{margin:0;padding:0}body{min-height:100vh;min-height:-webkit-fill-available;min-height:-moz-available;scroll-behavior:smooth}ul{list-style:none}a:not([class]){text-decoration-skip-ink:auto}img{max-width:100%;display:block}@media (prefers-reduced-motion:reduce){*{animation-duration:1ms!important;animation-iteration-count:1!important;scroll-behavior:auto!important}}body{font-family:var(--font-family-system);display:flex;flex-direction:column;font-weight:300;font-size:16px}a:link{color:var(--color-link)}.page__content{padding:0 var(--page-gap-horizontal);max-width:calc(var(--page-max-width) + 2 * var(--page-gap-horizontal));margin:var(--space-s) auto 0;flex:1 0 auto;display:flex;flex-direction:column;width:100%}.formatted-text{font-size:var(--font-size,var(--step-0));line-height:var(--line-height,1.5);min-height:0}.formatted-text *+*{margin-top:var(--space-m)}.formatted-text a{color:var(--color,var(--color-link));text-decoration:underline;text-decoration-color:var(--color-border,hsla(var(--color-link-base),80%,50%));text-decoration-skip-ink:auto;text-underline-offset:2px;text-decoration-thickness:1px}.formatted-text a:visited{color:var(--color-visited,var(--color-link-visited));text-decoration-color:var(--color-border-visited,hsla(var(--color-link-visited-base),40%,50%))}.header{display:flex;align-items:center;padding:8px var(--page-gap-horizontal);flex:0 0 auto;max-width:calc(var(--page-max-width) + 2 * var(--page-gap-horizontal));width:100%;margin:0 auto}.header__photo{width:48px;height:48px;border-radius:100%;overflow:hidden;margin-right:8px;flex:0 0 auto}.header__home{font-size:1rem;margin-right:16px}.header__home-link{display:flex;align-items:center}.navigation__list{display:flex;align-items:center}.navigation__item a{display:block;padding:4px;border-radius:4px}.post{max-width:50em;display:flex;flex-direction:column;flex:1 0 auto}.post__title{margin-bottom:var(--space-xs)}.post__info{display:flex;flex-wrap:wrap;margin-bottom:var(--space-m)}.post__reading::before{content:"/";display:inline-block;margin:0 8px}.post__content{flex:1 0 auto}.visually-hidden{clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}.link{color:var(--color,var(--color-link));text-decoration:underline;text-decoration-color:var(--color-border,hsla(var(--color-link-base),80%,50%));text-decoration-skip-ink:auto;text-underline-offset:2px;text-decoration-thickness:1px}</style>
<link rel="stylesheet" href="/styles/index-65ab20cca9.css" media="print" onload="this.media='all'"><noscript><link rel="stylesheet" href="/styles/index-65ab20cca9.css" media="screen"></noscript></head><body><header class="header"><h1 class="header__home"><a class="header__home-link link" href="/"><img class="header__photo" src="/images/menu-photo.jpg" srcset="/images/menu-photo.jpg, /images/menu-photo@2x.jpg 2x" width="48" height="48" alt=""><div class="header__home-text p-1">Mitya Kuznetsov</div></a></h1><nav class="navigation"><ul class="navigation__list"><li class="navigation__item p-1"><a class="link" href="/about/">About Me</a></li></ul></nav></header><main class="page__content"><article class="post"><h1 class="post__title header-1">Blocks&#39; random alignment with CSS</h1><div class="post__info p-1"><span class="visually-hidden">Published on</span> <time class="post__date" datetime="2020-10-01">October 1, 2020</time><div class="post__reading" aria-hidden="true">4 min to read</div></div><div class="post__content formatted-text"><p>Recently I had a nice CSS challenge - easy at first sight, but as usual, it happens, a bit tricky.</p><p>I needed to create a simple component in which several text blocks (let's call them tags) are displayed at random order. Something like that.</p><div class="snippet"><p class="codepen" data-height="265" data-theme-id="light" data-default-tab="css,result" data-user="frontendj" data-slug-hash="KKzzorz" style="height:265px;box-sizing:border-box;display:flex;align-items:center;justify-content:center;border:2px solid;margin:1em 0;padding:1em" data-pen-title="CSS random align - 1 - static blocks"><span>See the Pen <a href="https://codepen.io/frontendj/pen/KKzzorz">CSS random align - 1 - static blocks</a> by Dmitry (<a href="https://codepen.io/frontendj">@frontendj</a>) on <a href="https://codepen.io">CodePen</a>.</span></p></div><p>The initial markup was simple, and the result was quite boring. Considering that actually all the blocks weren't related to each other, there was a feeling, that they needed some dynamic, and I wanted to move them randomly in different directions. And here lied the challenge. I didn't know widths of blocks (cause inner text was random), I didn't know the width of the parent (cause markup was responsive), plus some blocks took 100% of the parent's width, so I couldn't move them at all.</p><p>Ideally, I wanted to calculate somehow the random length of a shift for every text block.</p><pre class="language-css"><code class="language-css"><span class="token selector">.item</span> <span class="token punctuation">{</span><br>    <span class="token property">left</span><span class="token punctuation">:</span> <span class="token function">random</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> [parentWidth] - [itemWidth]<span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre><p>SCSS has a built-in function for randomizing, but we can't mix there absolute and relative dimensions, and anyway, the result would be static. So it seemed that nothing could be solved in that direction.</p><p>I could try to generate just a random number within some reasonable range and try to shift the text blocks with its help. But in this case, I would have to adjust the maximum width for the blocks, otherwise, they will go beyond the boundaries of the parent.</p><pre class="language-css"><code class="language-css"><span class="token atrule"><span class="token rule">@for</span> $i from 1 through 4</span> <span class="token punctuation">{</span><br>    <span class="token selector">.item:nth-child(#</span><span class="token punctuation">{</span>$i<span class="token punctuation">}</span><span class="token selector">)</span> <span class="token punctuation">{</span><br>        $<span class="token property">random</span><span class="token punctuation">:</span> <span class="token function">random</span><span class="token punctuation">(</span>30<span class="token punctuation">)</span> - 15<span class="token punctuation">;</span> // getting a shift between -15px and 15px<br>        <span class="token property">margin-left</span><span class="token punctuation">:</span> $random + px<span class="token selector">;<br>        max-width: calc(100% - #</span><span class="token punctuation">{</span>2 * <span class="token function">abs</span><span class="token punctuation">(</span>$random<span class="token punctuation">)</span><span class="token punctuation">}</span>px<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><div class="snippet"><p class="codepen" data-height="265" data-theme-id="light" data-default-tab="css,result" data-user="frontendj" data-slug-hash="PoNNRLr" style="height:265px;box-sizing:border-box;display:flex;align-items:center;justify-content:center;border:2px solid;margin:1em 0;padding:1em" data-pen-title="CSS random align - 2 -  SCSS random"><span>See the Pen <a href="https://codepen.io/frontendj/pen/PoNNRLr">CSS random align - 2 - SCSS random</a> by Dmitry (<a href="https://codepen.io/frontendj">@frontendj</a>) on <a href="https://codepen.io">CodePen</a>.</span></p></div><p>Anyway, I tried and it seemed to work. But for long text blocks, some of the inner data were trimmed, because I had to compensate their shift with decreasing their width. In such cases, I'd like to just leave blocks without shifting. Luckily some flexbox magic came to help.</p><p>If we add blocks of random width before and after each tag, they will push and pull, and therefore balance the tag randomly. Also, they will shrink to zero width if the text block is too wide.</p><pre class="language-css"><code class="language-css"><span class="token selector">.item</span> <span class="token punctuation">{</span><br>    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token selector">;<br><br>    &amp;::before,<br>    &amp;::after</span> <span class="token punctuation">{</span><br>        <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">;</span><br>        <span class="token property">flex</span><span class="token punctuation">:</span> 1 1 auto<span class="token punctuation">;</span><br>        <span class="token property">background</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span><br>        <span class="token property">max-width</span><span class="token punctuation">:</span> 40%<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token selector">&amp;::after</span> <span class="token punctuation">{</span><br>        <span class="token property">background</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token atrule"><span class="token rule">@for</span> $i from 1 through 4</span> <span class="token punctuation">{</span><br>    <span class="token selector">.item:nth-child(#</span><span class="token punctuation">{</span>$i<span class="token punctuation">}</span><span class="token selector">)</span> <span class="token punctuation">{</span><br>        <span class="token selector">&amp;::before</span> <span class="token punctuation">{</span><br>            <span class="token property">flex-grow</span><span class="token punctuation">:</span> <span class="token function">random</span><span class="token punctuation">(</span>5<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br><br>        <span class="token selector">&amp;::after</span> <span class="token punctuation">{</span><br>            <span class="token property">flex-grow</span><span class="token punctuation">:</span> <span class="token function">random</span><span class="token punctuation">(</span>5<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>It works! Long tags displace balancers, and short tags are randomly aligned.</p><div class="snippet"><p class="codepen" data-height="265" data-theme-id="light" data-default-tab="css,result" data-user="frontendj" data-slug-hash="oNxxdgQ" style="height:265px;box-sizing:border-box;display:flex;align-items:center;justify-content:center;border:2px solid;margin:1em 0;padding:1em" data-pen-title="CSS random align - 3 - pushers and pullers"><span>See the Pen <a href="https://codepen.io/frontendj/pen/oNxxdgQ">CSS random align - 3 - pushers and pullers</a> by Dmitry (<a href="https://codepen.io/frontendj">@frontendj</a>) on <a href="https://codepen.io">CodePen</a>.</span></p></div><p>I could stop at this, but still I would like to add some real dynamics to make the text blocks appear with a random shift every time the block is redrawn, and not just when the CSS is recompiled. So a little bit of javascript would be fine:</p><pre class="language-js"><code class="language-js"><span class="token punctuation">[</span><span class="token operator">...</span>document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">'item'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      item<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">'--puller-grow'</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      item<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">'--pusher-grow'</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><div class="snippet"><p class="codepen" data-height="265" data-theme-id="light" data-default-tab="css,result" data-user="frontendj" data-slug-hash="JjXXvRm" style="height:265px;box-sizing:border-box;display:flex;align-items:center;justify-content:center;border:2px solid;margin:1em 0;padding:1em" data-pen-title="CSS random align - 4 - JS random"><span>See the Pen <a href="https://codepen.io/frontendj/pen/JjXXvRm">CSS random align - 4 - JS random</a> by Dmitry (<a href="https://codepen.io/frontendj">@frontendj</a>) on <a href="https://codepen.io">CodePen</a>.</span></p></div><p>Now everything is fine. Blocks are randomly arranged, stay within the parent's bounds, and make the most of the available space to display their content.</p><p>I stopped here, cause the font that I used, didn't give me the possibility to add some real dynamic to the blocks, and let them slowly slide back and forth. But I was surprised, that it actually can be done with changing flex-basis property. The result isn't spectacular though.</p><div class="snippet"><p class="codepen" data-height="265" data-theme-id="light" data-default-tab="css,result" data-user="frontendj" data-slug-hash="WNwoxgL" style="height:265px;box-sizing:border-box;display:flex;align-items:center;justify-content:center;border:2px solid;margin:1em 0;padding:1em" data-pen-title="CSS random align - 5 - flex-basis animation"><span>See the Pen <a href="https://codepen.io/frontendj/pen/WNwoxgL">CSS random align - 5 - flex-basis animation</a> by Dmitry (<a href="https://codepen.io/frontendj">@frontendj</a>) on <a href="https://codepen.io">CodePen</a>.</span></p><script async src="https://static.codepen.io/assets/embed/ei.js" crossorigin></script></div></div><div class="post__footer"><div class="post__tags p-1"><span class="visually-hidden">Post tags</span><a href="/tags/css/" class="post__tag link"> <span class="visually-hidden">Tag</span> <span aria-hidden="true">#</span>CSS</a></div><div class="post__navigation"><nav aria-label="Post navigation"><ul class="content-nav"><li class="content-nav__item content-nav__item--next p-1"><a class="content-nav__link link link--has-visited" href="/posts/til/2020-12-11-form-attribute/" aria-label="Next post ‚Äî TIL: Form attribute">TIL: Form attribute</a></li></ul></nav></div></div></article></main><script async src="/scripts/index-b75fa58ab1.js"></script></body></html>